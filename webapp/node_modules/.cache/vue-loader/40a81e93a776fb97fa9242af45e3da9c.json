{"remainingRequest":"/usr/local/lib/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mcs/Desktop/MyGit/evd_pulse/webapp/src/dashboard/db.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mcs/Desktop/MyGit/evd_pulse/webapp/src/dashboard/db.vue","mtime":1587697987737},{"path":"/usr/local/lib/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/usr/local/lib/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBmaXJlYmFzZSBmcm9tICdmaXJlYmFzZScKaW1wb3J0IENoYXJ0IGZyb20gJ2NoYXJ0LmpzJwoKZXhwb3J0IGRlZmF1bHQgewogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBjdXJyZW50OiBudWxsLAogICAgICAgICAgICBicG1fb2JqZWN0OiB7fSwKICAgICAgICAgICAgYnBtX2FycmF5OiBbXSwKICAgICAgICAgICAgYnBtX2FycmF5X3NlcGVyYXRlOiB7CiAgICAgICAgICAgICAgICB0aW1lc3RhbXBzOiBbXSwKICAgICAgICAgICAgICAgIGJwbXM6IFtdCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9LAogICAgY3JlYXRlZCgpIHsKICAgICAgICBsZXQgY3VycmVudCA9IHt9CiAgICAgICAgbGV0IGJwbV9vYmplY3QgPSB7fQoKICAgICAgICAvLyBGZXRjaCBkYXRhIGZyb20gRmlyZWJhc2UKICAgICAgICBsZXQgZGF0YWJhc2UgPSBmaXJlYmFzZS5kYXRhYmFzZSgpCgogICAgICAgIGRhdGFiYXNlLnJlZignY3VycmVudCcpLm9uY2UoJ3ZhbHVlJykudGhlbigoc25hcHNob3QpID0+IHsKICAgICAgICAgICAgY3VycmVudCA9IHNuYXBzaG90LnZhbCgpCiAgICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgICAgIHRoaXMuY3VycmVudCA9IGN1cnJlbnRbJ2JwbSddCiAgICAgICAgfSkKCiAgICAgICAgLy8gTWVzc3VyZW1lbnQgSGlzdG9yeSBsb2cKICAgICAgICBkYXRhYmFzZS5yZWYoJ2hpc3RvcnknKS5vbmNlKCd2YWx1ZScpLnRoZW4oKHNuYXBzaG90KSA9PiB7CiAgICAgICAgICAgIGJwbV9vYmplY3QgPSBzbmFwc2hvdC52YWwoKQogICAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgICAgICAKICAgICAgICAgICAgbGV0IGJwbV9hcnJheSA9IFtdCiAgICAgICAgICAgIGxldCB0aW1lc3RhbXBzID0gW10KICAgICAgICAgICAgbGV0IGJwbXMgPSBbXQoKICAgICAgICAgICAgLy8gQ29udmVydCBPYmplY3QgdG8gQXJyYXkKICAgICAgICAgICAgZm9yIChsZXQgbG9nIGluIGJwbV9vYmplY3QpIHsKICAgICAgICAgICAgICAgIGxldCB0ZW1wX2FycmF5ID0gT2JqZWN0LnZhbHVlcyhicG1fb2JqZWN0W2xvZ10pCiAgICAgICAgICAgICAgICBicG1fYXJyYXkucHVzaChbcGFyc2VJbnQodGVtcF9hcnJheVsxXSksIHRlbXBfYXJyYXlbMF1dKQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBTb3J0aW5nIEFycmF5CiAgICAgICAgICAgIGJwbV9hcnJheS5zb3J0KGZ1bmN0aW9uKGEsIGIpIHsKICAgICAgICAgICAgICAgIHJldHVybiAoYVswXSA+IGJbMF0pID8gMSA6IChhWzBdIDwgYlswXSkgPyAtMSA6IDAKICAgICAgICAgICAgfSkKCiAgICAgICAgICAgIC8vIFNlcGVyYXRlIEJQTSBhbmQgVGltZXN0YW1wCiAgICAgICAgICAgIGZvciAobGV0IGk9MDsgaSA8IGJwbV9hcnJheS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgdGltZXN0YW1wcy5wdXNoKGJwbV9hcnJheVtpXVswXSkKICAgICAgICAgICAgICAgIGJwbXMucHVzaChicG1fYXJyYXlbaV1bMV0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICAgIHRoaXMuYnBtX2FycmF5ID0gYnBtX2FycmF5CiAgICAgICAgICAgIHRoaXMuYnBtX2FycmF5X3NlcGVyYXRlLnRpbWVzdGFtcHMgPSB0aW1lc3RhbXBzCiAgICAgICAgICAgIHRoaXMuYnBtX2FycmF5X3NlcGVyYXRlLmJwbXMgPSBicG1zCgogICAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgICAgICAKICAgICAgICAgICAgbGV0IHRpbWVzdGFtcHMgPSB0aGlzLmJwbV9hcnJheV9zZXBlcmF0ZS50aW1lc3RhbXBzCiAgICAgICAgICAgIGxldCBkYXRlcyA9IHRpbWVzdGFtcHMubWFwKGZ1bmN0aW9uICh0aW1lc3RhbXApIHsKICAgICAgICAgICAgICAgIGxldCBkYXRlID0gbmV3IERhdGUodGltZXN0YW1wICogMTAwMCkKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSh0aW1lc3RhbXAgKiAxMDAwKS50b0xvY2FsZVRpbWVTdHJpbmcoKQogICAgICAgICAgICB9KQoKICAgICAgICAgICAgLy8gSGlzdG9yeSBCUE0gJ3MgQ2hhcnQgQ29tcG9uZW50cwogICAgICAgICAgICBsZXQgaGJwbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoaXN0b3J5QlBNJykuZ2V0Q29udGV4dCgnMmQnKTsKICAgICAgICAgICAgbmV3IENoYXJ0KGhicG0sIHsKICAgICAgICAgICAgICAgIHR5cGU6ICdsaW5lJywKICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgICBsYWJlbHM6IGRhdGVzLAogICAgICAgICAgICAgICAgICAgIGRhdGFzZXRzOiBbewogICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ0JlYXQgcGVyIE1pbnV0ZScsCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHRoaXMuYnBtX2FycmF5X3NlcGVyYXRlLmJwbXMsCiAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlckNvbG9yOiAnaHNsKDM0OCwgODMlLCA0NyUpJywKICAgICAgICAgICAgICAgICAgICAgICAgZmlsbDogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBvcHRpb25zOiB7CiAgICAgICAgICAgICAgICAgICAgbGVnZW5kOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB0b29sdGlwczogewogICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKCiAgICAgICAgfSkKICAgIH0sCiAgICBtb3VudGVkKCkgewoKICAgICAgICBsZXQgZWNnUHVsc2VzID0gbmV3IEFycmF5KDQwKS5tYXAoKGkpID0+IHsKICAgICAgICAgICAgcmV0dXJuIDAKICAgICAgICB9KTsKICAgICAgICAvLyBbMCwgMCwgMiwgLTgsIDgsIC0yLCAwLCAwXQogICAgICAgIC8vIGZvciAobGV0IGk9MDsgaTxlY2dQdWxzZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyAgICAgZWNnUHVsc2VzW2ldID0gMAogICAgICAgIC8vIH0KCiAgICAgICAgLy8gRUNHIFB1bHNlIGluIFJlYWwtdGltZSBQYW5lbAogICAgICAgIGxldCBjZWNnID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1cnJlbnRFQ0cnKS5nZXRDb250ZXh0KCcyZCcpOwogICAgICAgIG5ldyBDaGFydChjZWNnLCB7CiAgICAgICAgICAgIHR5cGU6ICdsaW5lJywKICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICAgbGFiZWxzOiBuZXcgQXJyYXkoNDApLAogICAgICAgICAgICAgICAgZGF0YXNldHM6IFt7CiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdFQ0cnLAogICAgICAgICAgICAgICAgICAgIGRhdGE6IGVjZ1B1bHNlcywKICAgICAgICAgICAgICAgICAgICBib3JkZXJDb2xvcjogJyNGRkYnLAogICAgICAgICAgICAgICAgICAgIGZpbGw6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGxpbmVUZW5zaW9uOiAwLjEsCiAgICAgICAgICAgICAgICAgICAgcG9pbnRCb3JkZXJDb2xvcjogJ3JnYmEoMCwgMCwgMCwgMCknLAogICAgICAgICAgICAgICAgICAgIHBvaW50QmFja2dyb3VuZENvbG9yOiAncmdiYSgwLCAwLCAwLCAwKScsCgogICAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgb3B0aW9uczogewogICAgICAgICAgICAgICAgdGl0bGU6IHsKICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBmYWxzZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGxlZ2VuZDogewogICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZhbHNlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgdG9vbHRpcHM6IHsKICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiBmYWxzZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHNjYWxlczogewogICAgICAgICAgICAgICAgICAgIHhBeGVzOiBbewogICAgICAgICAgICAgICAgICAgICAgICBncmlkTGluZXM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHRpY2tzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfV0sCiAgICAgICAgICAgICAgICAgICAgeUF4ZXM6IFt7CiAgICAgICAgICAgICAgICAgICAgICAgIGdyaWRMaW5lczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgdGlja3M6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9XQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSkKICAgIH0sCiAgICBjb21wdXRlZDogewogICAgICAgIExhc3Q1X0JQTXJldmVyc2VTb3J0ZWRBcnJheTogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGxldCBicG1fYXJyYXkgPSB0aGlzLmJwbV9hcnJheQoKICAgICAgICAgICAgLy8gUmV2ZXJzZSBTb3J0aW5nIENvbXBhcmF0b3IKICAgICAgICAgICAgZnVuY3Rpb24gcmV2ZXJzZVNvcnQoYSwgYikgewogICAgICAgICAgICAgICAgcmV0dXJuIChhWzBdID4gYlswXSkgPyAtMSA6IChhWzBdIDwgYlswXSkgPyAxIDogMAogICAgICAgICAgICB9CgogICAgICAgICAgICBicG1fYXJyYXkuc29ydChyZXZlcnNlU29ydCkgICAgICAgICAvLyBERVNDIFNvcnRpbmcgQlBNIEFycmF5CiAgICAgICAgICAgIHJldHVybiBicG1fYXJyYXkuc2xpY2UoMCwgNSkgICAgICAgIC8vIFJldHVybiBvbmx5IDUgZmlyc3QgZWxlbWVudCBpbiBhcnJheSAocmV2ZXJzZWQpLgogICAgICAgIH0sCiAgICB9LAogICAgbWV0aG9kczogewoKICAgIH0KfQo="},{"version":3,"sources":["db.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0CA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"db.vue","sourceRoot":"src/dashboard","sourcesContent":["<template>\n    <div>\n        <div class=\"container-fluid i-bg-red p-5\">\n            <div class=\"h4 mb-0\">Dashboard</div>\n            <div class=\"row my-5\">\n                <div class=\"col-7\">\n                    <canvas id=\"currentECG\" width=\"100\" height=\"15\"></canvas>\n                </div>\n                <div class=\"col-5\">\n                    <div class=\"h3 mb-0\">Current Pulse</div>\n                    <div>\n                        <span class=\"display-4\">{{ current }}</span>\n                        <span class=\"ml-4\">BPMs</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"container-fluid p-5\">\n            <div class=\"row\">\n                <div class=\"col-4\">\n                    <div class=\"h5 mb-2\">5-Last Messurement</div>\n                    <div class=\"p-3 hislog\" v-for=\"log in Last5_BPMreverseSortedArray\" :key=\"log.index\">\n                        <div class=\"d-inline-block h5 mb-0\">{{ log[1] }} BPM</div>\n                        <div class=\"d-inline-block font-weight-light float-right\">{{ log[0] | moment(\"D MMM YYYY &#8212 hh:mm A\") }}</div>\n                    </div>\n                </div>\n                <div class=\"col-8\">\n                    <canvas id=\"historyBPM\"></canvas>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n<style scoped>\ndiv.hislog {\n    background-color: hsl(200, 50%, 97.5%);\n}\ndiv.hislog:nth-child(odd) {\n    background-color: hsl(200, 50%, 95%);\n}\n</style>\n<script>\nimport firebase from 'firebase'\nimport Chart from 'chart.js'\n\nexport default {\n    data() {\n        return {\n            current: null,\n            bpm_object: {},\n            bpm_array: [],\n            bpm_array_seperate: {\n                timestamps: [],\n                bpms: []\n            }\n        }\n    },\n    created() {\n        let current = {}\n        let bpm_object = {}\n\n        // Fetch data from Firebase\n        let database = firebase.database()\n\n        database.ref('current').once('value').then((snapshot) => {\n            current = snapshot.val()\n        }).then(() => {\n            this.current = current['bpm']\n        })\n\n        // Messurement History log\n        database.ref('history').once('value').then((snapshot) => {\n            bpm_object = snapshot.val()\n        }).then(() => {\n            \n            let bpm_array = []\n            let timestamps = []\n            let bpms = []\n\n            // Convert Object to Array\n            for (let log in bpm_object) {\n                let temp_array = Object.values(bpm_object[log])\n                bpm_array.push([parseInt(temp_array[1]), temp_array[0]])\n            }\n\n            // Sorting Array\n            bpm_array.sort(function(a, b) {\n                return (a[0] > b[0]) ? 1 : (a[0] < b[0]) ? -1 : 0\n            })\n\n            // Seperate BPM and Timestamp\n            for (let i=0; i < bpm_array.length; i++) {\n                timestamps.push(bpm_array[i][0])\n                bpms.push(bpm_array[i][1])\n            }\n            \n            this.bpm_array = bpm_array\n            this.bpm_array_seperate.timestamps = timestamps\n            this.bpm_array_seperate.bpms = bpms\n\n        }).then(() => {\n            \n            let timestamps = this.bpm_array_seperate.timestamps\n            let dates = timestamps.map(function (timestamp) {\n                let date = new Date(timestamp * 1000)\n                return new Date(timestamp * 1000).toLocaleTimeString()\n            })\n\n            // History BPM 's Chart Components\n            let hbpm = document.getElementById('historyBPM').getContext('2d');\n            new Chart(hbpm, {\n                type: 'line',\n                data: {\n                    labels: dates,\n                    datasets: [{\n                        label: 'Beat per Minute',\n                        data: this.bpm_array_seperate.bpms,\n                        borderColor: 'hsl(348, 83%, 47%)',\n                        fill: false,\n                    }]\n                },\n                options: {\n                    legend: {\n                        display: false\n                    },\n                    tooltips: {\n                        enabled: false\n                    }\n                }\n            })\n\n        })\n    },\n    mounted() {\n\n        let ecgPulses = new Array(40).map((i) => {\n            return 0\n        });\n        // [0, 0, 2, -8, 8, -2, 0, 0]\n        // for (let i=0; i<ecgPulses.length; i++) {\n        //     ecgPulses[i] = 0\n        // }\n\n        // ECG Pulse in Real-time Panel\n        let cecg = document.getElementById('currentECG').getContext('2d');\n        new Chart(cecg, {\n            type: 'line',\n            data: {\n                labels: new Array(40),\n                datasets: [{\n                    label: 'ECG',\n                    data: ecgPulses,\n                    borderColor: '#FFF',\n                    fill: false,\n                    lineTension: 0.1,\n                    pointBorderColor: 'rgba(0, 0, 0, 0)',\n                    pointBackgroundColor: 'rgba(0, 0, 0, 0)',\n\n                }]\n            },\n            options: {\n                title: {\n                    display: false\n                },\n                legend: {\n                    display: false\n                },\n                tooltips: {\n                    enabled: false\n                },\n                scales: {\n                    xAxes: [{\n                        gridLines: {\n                            display: false\n                        },\n                        ticks: {\n                            display: false\n                        }\n                    }],\n                    yAxes: [{\n                        gridLines: {\n                            display: false\n                        },\n                        ticks: {\n                            display: false\n                        }\n                    }]\n                }\n            }\n        })\n    },\n    computed: {\n        Last5_BPMreverseSortedArray: function() {\n            let bpm_array = this.bpm_array\n\n            // Reverse Sorting Comparator\n            function reverseSort(a, b) {\n                return (a[0] > b[0]) ? -1 : (a[0] < b[0]) ? 1 : 0\n            }\n\n            bpm_array.sort(reverseSort)         // DESC Sorting BPM Array\n            return bpm_array.slice(0, 5)        // Return only 5 first element in array (reversed).\n        },\n    },\n    methods: {\n\n    }\n}\n</script>"]}]}