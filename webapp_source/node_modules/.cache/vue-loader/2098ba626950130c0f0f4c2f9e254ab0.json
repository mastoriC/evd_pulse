{"remainingRequest":"/usr/local/lib/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mcs/Desktop/MyGit/evd_pulse/webapp/src/dashboard/db.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mcs/Desktop/MyGit/evd_pulse/webapp/src/dashboard/db.vue","mtime":1588085513439},{"path":"/usr/local/lib/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/usr/local/lib/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBmaXJlYmFzZSBmcm9tICdmaXJlYmFzZScKaW1wb3J0IENoYXJ0IGZyb20gJ2NoYXJ0LmpzJwoKZXhwb3J0IGRlZmF1bHQgewogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBjdXJyZW50OiAnLScsCiAgICAgICAgICAgIHB1bHNlOiAnLScsCiAgICAgICAgICAgIGJwbV9vYmplY3Q6IHt9LAogICAgICAgICAgICBicG1fYXJyYXk6IFtdLAogICAgICAgICAgICBicG1fYXJyYXlfc2VwZXJhdGU6IHsKICAgICAgICAgICAgICAgIHRpbWVzdGFtcHM6IFtdLAogICAgICAgICAgICAgICAgYnBtczogW10KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICBtb3VudGVkKCkgewogICAgICAgIGxldCBicG1fb2JqZWN0ID0ge30KCiAgICAgICAgLy8gSGlzdG9yeSBCUE0gJ3MgQ2hhcnQgQ29tcG9uZW50cwogICAgICAgIGxldCBoYnBtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hpc3RvcnlCUE0nKS5nZXRDb250ZXh0KCcyZCcpOwogICAgICAgIGxldCBoYnBtX2NoYXJ0ID0gbmV3IENoYXJ0KGhicG0sIHsKICAgICAgICAgICAgdHlwZTogJ2xpbmUnLAogICAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgICAgICBsYWJlbHM6IHRoaXMuYnBtX2FycmF5X3NlcGVyYXRlLnRpbWVzdGFtcHMsCiAgICAgICAgICAgICAgICBkYXRhc2V0czogW3sKICAgICAgICAgICAgICAgICAgICBsYWJlbDogJ0JlYXQgcGVyIE1pbnV0ZScsCiAgICAgICAgICAgICAgICAgICAgZGF0YTogdGhpcy5icG1fYXJyYXlfc2VwZXJhdGUuYnBtcywKICAgICAgICAgICAgICAgICAgICBib3JkZXJDb2xvcjogJ2hzbCgzNDgsIDgzJSwgNDclKScsCiAgICAgICAgICAgICAgICAgICAgZmlsbDogZmFsc2UsCiAgICAgICAgICAgICAgICB9XQogICAgICAgICAgICB9LAogICAgICAgICAgICBvcHRpb25zOiB7CiAgICAgICAgICAgICAgICBsZWdlbmQ6IHsKICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBmYWxzZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHRvb2x0aXBzOiB7CiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDogZmFsc2UKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0pCgogICAgICAgIGZ1bmN0aW9uIHRpbWUyZGF0ZSh0aW1lc3RhbXApIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKHRpbWVzdGFtcCkudG9Mb2NhbGVUaW1lU3RyaW5nKCkKICAgICAgICB9CgogICAgICAgIC8vIEZldGNoIGRhdGEgZnJvbSBGaXJlYmFzZQogICAgICAgIGxldCBkYXRhYmFzZSA9IGZpcmViYXNlLmRhdGFiYXNlKCkKCiAgICAgICAgZGF0YWJhc2UucmVmKCdjdXJyZW50L2JwbScpLm9uKCd2YWx1ZScsIChzbmFwc2hvdCkgPT4gewogICAgICAgICAgICB0aGlzLmN1cnJlbnQgPSBzbmFwc2hvdC52YWwoKQogICAgICAgIH0pCiAgICAgICAgZGF0YWJhc2UucmVmKCdjdXJyZW50L3B1bHNlJykub24oJ3ZhbHVlJywgKHNuYXBzaG90KSA9PiB7CiAgICAgICAgICAgIHRoaXMucHVsc2UgPSBzbmFwc2hvdC52YWwoKQogICAgICAgIH0pCgogICAgICAgIC8vIE1lc3N1cmVtZW50IEhpc3RvcnkgbG9nCiAgICAgICAgZGF0YWJhc2UucmVmKCdoaXN0b3J5Jykub24oJ2NoaWxkX2FkZGVkJywgKHNuYXBzaG90KSA9PiB7CiAgICAgICAgICAgIGJwbV9vYmplY3QgPSBzbmFwc2hvdC52YWwoKQogICAgICAgICAgICB0aGlzLmJwbV9hcnJheS5wdXNoKFticG1fb2JqZWN0Wyd0aW1lc3RhbXAnXSwgYnBtX29iamVjdFsnYnBtJ11dKQogICAgICAgICAgICB0aGlzLmJwbV9hcnJheV9zZXBlcmF0ZS50aW1lc3RhbXBzLnB1c2godGltZTJkYXRlKGJwbV9vYmplY3RbJ3RpbWVzdGFtcCddKSkKICAgICAgICAgICAgdGhpcy5icG1fYXJyYXlfc2VwZXJhdGUuYnBtcy5wdXNoKGJwbV9vYmplY3RbJ2JwbSddKQogICAgICAgICAgICBpZiAodGhpcy5icG1fYXJyYXkubGVuZ3RoID4gMTUpIHsKICAgICAgICAgICAgICAgIHRoaXMuYnBtX2FycmF5LnNoaWZ0KCkKICAgICAgICAgICAgICAgIHRoaXMuYnBtX2FycmF5X3NlcGVyYXRlLnRpbWVzdGFtcHMuc2hpZnQoKQogICAgICAgICAgICAgICAgdGhpcy5icG1fYXJyYXlfc2VwZXJhdGUuYnBtcy5zaGlmdCgpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaGJwbV9jaGFydC51cGRhdGUoKQogICAgICAgIH0pCgogICAgICAgIGxldCBlY2dQdWxzZXMgPSBuZXcgQXJyYXkoNTApCiAgICAgICAgZm9yIChsZXQgaT0wOyBpPGVjZ1B1bHNlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBlY2dQdWxzZXNbaV0gPSAnLScKICAgICAgICB9CgogICAgICAgIC8vIEVDRyBQdWxzZSBpbiBSZWFsLXRpbWUgUGFuZWwKICAgICAgICBsZXQgY2VjZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXJyZW50RUNHJykuZ2V0Q29udGV4dCgnMmQnKTsKICAgICAgICBsZXQgY2VjZ19jaGFydCA9IG5ldyBDaGFydChjZWNnLCB7CiAgICAgICAgICAgIHR5cGU6ICdsaW5lJywKICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICAgbGFiZWxzOiBuZXcgQXJyYXkoNTApLAogICAgICAgICAgICAgICAgZGF0YXNldHM6IFt7CiAgICAgICAgICAgICAgICAgICAgbGFiZWw6ICdFQ0cnLAogICAgICAgICAgICAgICAgICAgIGRhdGE6IGVjZ1B1bHNlcywKICAgICAgICAgICAgICAgICAgICBib3JkZXJDb2xvcjogJyNGRkYnLAogICAgICAgICAgICAgICAgICAgIGZpbGw6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIGxpbmVUZW5zaW9uOiAwLjEsCiAgICAgICAgICAgICAgICAgICAgcG9pbnRCb3JkZXJDb2xvcjogJ3JnYmEoMCwgMCwgMCwgMCknLAogICAgICAgICAgICAgICAgICAgIHBvaW50QmFja2dyb3VuZENvbG9yOiAncmdiYSgwLCAwLCAwLCAwKScsCiAgICAgICAgICAgICAgICAgICAgYm9yZGVyV2lkdGg6IDEKCiAgICAgICAgICAgICAgICB9XQogICAgICAgICAgICB9LAogICAgICAgICAgICBvcHRpb25zOiB7CiAgICAgICAgICAgICAgICB0aXRsZTogewogICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZhbHNlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgbGVnZW5kOiB7CiAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogZmFsc2UKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB0b29sdGlwczogewogICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgc2NhbGVzOiB7CiAgICAgICAgICAgICAgICAgICAgeEF4ZXM6IFt7CiAgICAgICAgICAgICAgICAgICAgICAgIGdyaWRMaW5lczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgdGlja3M6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9XSwKICAgICAgICAgICAgICAgICAgICB5QXhlczogW3sKICAgICAgICAgICAgICAgICAgICAgICAgZ3JpZExpbmVzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICB0aWNrczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH1dCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KQoKICAgICAgICAvLyBVcGRhdGUgZWNnR3JhcGggZXZlcnkgMTAwbXMKICAgICAgICBjb25zdCBlY2dHcmFwaCA9ICgpID0+IHsKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgICBlY2dQdWxzZXMudW5zaGlmdCh0aGlzLnB1bHNlKQogICAgICAgICAgICAgICAgZWNnUHVsc2VzLnBvcCgpCiAgICAgICAgICAgICAgICBjZWNnX2NoYXJ0LnVwZGF0ZSgpCiAgICAgICAgICAgICAgICBlY2dHcmFwaCgpCiAgICAgICAgICAgIH0sIDEwMCkKICAgICAgICB9CiAgICAgICAgZWNnR3JhcGgoKQogICAgfSwKICAgIGNvbXB1dGVkOiB7CiAgICAgICAgTGFzdDVfQlBNcmV2ZXJzZVNvcnRlZEFycmF5OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgbGV0IGJwbV9hcnJheSA9IHRoaXMuYnBtX2FycmF5CgogICAgICAgICAgICAvLyBSZXZlcnNlIFNvcnRpbmcgQ29tcGFyYXRvcgogICAgICAgICAgICBmdW5jdGlvbiByZXZlcnNlU29ydChhLCBiKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKGFbMF0gPiBiWzBdKSA/IC0xIDogKGFbMF0gPCBiWzBdKSA/IDEgOiAwCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJwbV9hcnJheS5zb3J0KHJldmVyc2VTb3J0KSAgICAgICAgIC8vIERFU0MgU29ydGluZyBCUE0gQXJyYXkKICAgICAgICAgICAgcmV0dXJuIGJwbV9hcnJheS5zbGljZSgwLCA1KSAgICAgICAgLy8gUmV0dXJuIG9ubHkgNSBmaXJzdCBlbGVtZW50IGluIGFycmF5IChyZXZlcnNlZCkuCiAgICAgICAgfSwKICAgIH0sCiAgICBtZXRob2RzOiB7CgogICAgfQp9Cg=="},{"version":3,"sources":["db.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"db.vue","sourceRoot":"src/dashboard","sourcesContent":["<template>\n    <div>\n        <div class=\"container-fluid i-bg-red p-5\">\n            <div class=\"h4 mb-0\">Dashboard</div>\n            <div class=\"row my-5\">\n                <div class=\"col-7\">\n                    <canvas id=\"currentECG\" width=\"100\" height=\"15\"></canvas>\n                </div>\n                <div class=\"col-5\">\n                    <div class=\"h3\">Current Pulse</div>\n                    <div v-if=\"current != '-'\">\n                        <span class=\"display-4\">{{ current }}</span>\n                        <span class=\"ml-4\">BPMs</span>\n                    </div>\n                    <div v-else>\n                        <span class=\"h5\">No pulse detected</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"container-fluid p-5\">\n            <div class=\"row\">\n                <div class=\"col-4\">\n                    <div class=\"h5 mb-2\">5-Last Messurement</div>\n                    <div class=\"p-3 hislog\" v-for=\"log in Last5_BPMreverseSortedArray\" :key=\"log.index\">\n                        <div class=\"d-inline-block h5 mb-0\">{{ log[1] }} BPM</div>\n                        <div class=\"d-inline-block font-weight-light float-right\">{{ log[0] | moment(\"D MMM YYYY &#8212 hh:mm A\") }}</div>\n                    </div>\n                </div>\n                <div class=\"col-8\">\n                    <canvas id=\"historyBPM\"></canvas>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n<style scoped>\ndiv.hislog {\n    background-color: hsl(200, 50%, 97.5%);\n}\ndiv.hislog:nth-child(odd) {\n    background-color: hsl(200, 50%, 95%);\n}\n</style>\n<script>\nimport firebase from 'firebase'\nimport Chart from 'chart.js'\n\nexport default {\n    data() {\n        return {\n            current: '-',\n            pulse: '-',\n            bpm_object: {},\n            bpm_array: [],\n            bpm_array_seperate: {\n                timestamps: [],\n                bpms: []\n            }\n        }\n    },\n    mounted() {\n        let bpm_object = {}\n\n        // History BPM 's Chart Components\n        let hbpm = document.getElementById('historyBPM').getContext('2d');\n        let hbpm_chart = new Chart(hbpm, {\n            type: 'line',\n            data: {\n                labels: this.bpm_array_seperate.timestamps,\n                datasets: [{\n                    label: 'Beat per Minute',\n                    data: this.bpm_array_seperate.bpms,\n                    borderColor: 'hsl(348, 83%, 47%)',\n                    fill: false,\n                }]\n            },\n            options: {\n                legend: {\n                    display: false\n                },\n                tooltips: {\n                    enabled: false\n                }\n            }\n        })\n\n        function time2date(timestamp) {\n            return new Date(timestamp).toLocaleTimeString()\n        }\n\n        // Fetch data from Firebase\n        let database = firebase.database()\n\n        database.ref('current/bpm').on('value', (snapshot) => {\n            this.current = snapshot.val()\n        })\n        database.ref('current/pulse').on('value', (snapshot) => {\n            this.pulse = snapshot.val()\n        })\n\n        // Messurement History log\n        database.ref('history').on('child_added', (snapshot) => {\n            bpm_object = snapshot.val()\n            this.bpm_array.push([bpm_object['timestamp'], bpm_object['bpm']])\n            this.bpm_array_seperate.timestamps.push(time2date(bpm_object['timestamp']))\n            this.bpm_array_seperate.bpms.push(bpm_object['bpm'])\n            if (this.bpm_array.length > 15) {\n                this.bpm_array.shift()\n                this.bpm_array_seperate.timestamps.shift()\n                this.bpm_array_seperate.bpms.shift()\n            }\n            hbpm_chart.update()\n        })\n\n        let ecgPulses = new Array(50)\n        for (let i=0; i<ecgPulses.length; i++) {\n            ecgPulses[i] = '-'\n        }\n\n        // ECG Pulse in Real-time Panel\n        let cecg = document.getElementById('currentECG').getContext('2d');\n        let cecg_chart = new Chart(cecg, {\n            type: 'line',\n            data: {\n                labels: new Array(50),\n                datasets: [{\n                    label: 'ECG',\n                    data: ecgPulses,\n                    borderColor: '#FFF',\n                    fill: false,\n                    lineTension: 0.1,\n                    pointBorderColor: 'rgba(0, 0, 0, 0)',\n                    pointBackgroundColor: 'rgba(0, 0, 0, 0)',\n                    borderWidth: 1\n\n                }]\n            },\n            options: {\n                title: {\n                    display: false\n                },\n                legend: {\n                    display: false\n                },\n                tooltips: {\n                    enabled: false\n                },\n                scales: {\n                    xAxes: [{\n                        gridLines: {\n                            display: false\n                        },\n                        ticks: {\n                            display: false\n                        }\n                    }],\n                    yAxes: [{\n                        gridLines: {\n                            display: false\n                        },\n                        ticks: {\n                            display: false\n                        }\n                    }]\n                }\n            }\n        })\n\n        // Update ecgGraph every 100ms\n        const ecgGraph = () => {\n            setTimeout(() => {\n                ecgPulses.unshift(this.pulse)\n                ecgPulses.pop()\n                cecg_chart.update()\n                ecgGraph()\n            }, 100)\n        }\n        ecgGraph()\n    },\n    computed: {\n        Last5_BPMreverseSortedArray: function() {\n            let bpm_array = this.bpm_array\n\n            // Reverse Sorting Comparator\n            function reverseSort(a, b) {\n                return (a[0] > b[0]) ? -1 : (a[0] < b[0]) ? 1 : 0\n            }\n\n            bpm_array.sort(reverseSort)         // DESC Sorting BPM Array\n            return bpm_array.slice(0, 5)        // Return only 5 first element in array (reversed).\n        },\n    },\n    methods: {\n\n    }\n}\n</script>"]}]}